# Test struct method that uses ref self and returns struct
struct Result:
    value: @str

struct Parser:
    data: @str
    
    fn create(d: @str) -> Parser:
        return Parser{data: d}
    
    fn simple_method(ref self) -> Result:
        print("DEBUG: Inside simple_method")
        print("DEBUG: self.data is:")
        print(self.data)
        return Result{value: "success"}

fn use_parser():
    var p = Parser.create("test data")
    print("DEBUG: Calling simple_method...")
    var r = p.simple_method()
    print("DEBUG: simple_method returned")
    print("DEBUG: result.value:")
    print(r.value)

use_parser()

mn:
    print("Done!")
